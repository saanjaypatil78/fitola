# Fitola Automation Guide

## ğŸ¯ Complete Automation Workflow

This guide demonstrates how to leverage Fitola's automated agentic systems to accelerate development from concept to deployment.

## ğŸ“‹ Table of Contents

1. [Automated Feature Development](#automated-feature-development)
2. [CI/CD Pipeline Setup](#cicd-pipeline-setup)
3. [Automated Testing](#automated-testing)
4. [Deployment Automation](#deployment-automation)
5. [Code Quality Automation](#code-quality-automation)
6. [Documentation Automation](#documentation-automation)

---

## ğŸš€ Automated Feature Development

### Complete Workflow: From Idea to Production

This workflow demonstrates building a complete feature using agentic automation.

### Example: Implementing "Workout History" Feature

#### Phase 1: Requirements & Planning (Sequential Thinking)

**Prompt to Agent**:
```
Using sequential thinking, help me plan a "Workout History" feature:

Requirements:
- Users can view past workouts
- Filter by date range and exercise type
- Statistics and charts
- Export to PDF
- Offline support

Please provide:
1. Database schema
2. API endpoints needed
3. Flutter screen structure
4. State management approach
5. Implementation steps
```

**Agent Output**:
```
[Sequential Analysis]

1. DATABASE SCHEMA:
   - workouts table (id, user_id, date, duration, calories)
   - workout_exercises table (workout_id, exercise_id, sets, reps, weight)
   - Link to existing users and exercises tables

2. API ENDPOINTS:
   GET /api/v1/workouts?user_id=X&start_date=Y&end_date=Z
   GET /api/v1/workouts/{id}
   POST /api/v1/workouts
   DELETE /api/v1/workouts/{id}
   GET /api/v1/workouts/stats?user_id=X

3. FLUTTER STRUCTURE:
   screens/
     - workout_history_screen.dart
     - workout_detail_screen.dart
   widgets/
     - workout_card.dart
     - workout_stats_chart.dart
   services/
     - workout_service.dart
   providers/
     - workout_history_provider.dart

4. STATE MANAGEMENT:
   - Use Provider for workout list state
   - Local caching with Hive/SQLite
   - Optimistic updates for better UX

5. IMPLEMENTATION STEPS:
   Step 1: Backend API (2 hours)
   Step 2: Database models (1 hour)
   Step 3: UI screens with Stitch (1 hour)
   Step 4: Services & providers (2 hours)
   Step 5: Testing (2 hours)
   Total: ~8 hours
```

#### Phase 2: UI Design (Stitch MCP)

**Prompt to Stitch**:
```
Generate a Flutter workout history screen:

Layout:
- App bar with "Workout History" title and filter icon
- Date range selector at top
- Scrollable list of workout cards
- Each card shows:
  * Exercise name and type
  * Date and duration
  * Calories burned
  * Small progress indicator
- Floating action button for new workout
- Bottom navigation bar

Theme:
- Material Design 3
- Support dark mode
- Use primary color #FF6B35
- Rounded corners (12px)
- Subtle shadows

Export as Flutter widget code
```

**Agent Output**:
```dart
// Generated by Stitch MCP
import 'package:flutter/material.dart';

class WorkoutHistoryScreen extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Workout History'),
        actions: [
          IconButton(
            icon: Icon(Icons.filter_list),
            onPressed: () {
              // TODO: Show filter dialog
            },
          ),
        ],
      ),
      body: Column(
        children: [
          DateRangeSelector(),
          Expanded(
            child: ListView.builder(
              itemCount: workouts.length,
              itemBuilder: (context, index) {
                return WorkoutCard(workout: workouts[index]);
              },
            ),
          ),
        ],
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: () {
          // TODO: Navigate to new workout
        },
        child: Icon(Icons.add),
      ),
    );
  }
}

class WorkoutCard extends StatelessWidget {
  final Workout workout;
  
  const WorkoutCard({required this.workout});
  
  @override
  Widget build(BuildContext context) {
    return Card(
      margin: EdgeInsets.symmetric(horizontal: 16, vertical: 8),
      shape: RoundedRectangleBorder(
        borderRadius: BorderRadius.circular(12),
      ),
      elevation: 2,
      child: ListTile(
        leading: CircleAvatar(
          backgroundColor: Theme.of(context).primaryColor,
          child: Icon(Icons.fitness_center, color: Colors.white),
        ),
        title: Text(workout.name),
        subtitle: Text('${workout.duration} min â€¢ ${workout.calories} cal'),
        trailing: Text(
          workout.date,
          style: TextStyle(fontSize: 12, color: Colors.grey),
        ),
        onTap: () {
          // TODO: Navigate to detail
        },
      ),
    );
  }
}
```

#### Phase 3: Backend Implementation (Sequential Thinking)

**Prompt to Agent**:
```
Generate FastAPI endpoints for workout history based on the schema:

Required:
- CRUD operations for workouts
- Authentication with JWT
- Pagination support
- Date range filtering
- Statistics aggregation
- Error handling
- Input validation with Pydantic
```

**Agent Output** (FastAPI code with all endpoints, models, validation)

#### Phase 4: Service Layer (Sequential Thinking)

**Prompt to Agent**:
```
Generate Flutter service layer for workout history:

Requirements:
- HTTP client with retry logic
- Error handling
- Offline caching
- Optimistic updates
- Type-safe models
```

**Agent Output** (Complete service implementation)

#### Phase 5: Testing (Sequential Thinking)

**Prompt to Agent**:
```
Generate comprehensive tests for workout history:

Test types:
- Unit tests for services
- Widget tests for UI
- Integration tests for flow
- Mock data fixtures
```

**Agent Output** (Complete test suite)

---

## ğŸ”„ CI/CD Pipeline Setup

### GitHub Actions Workflow

Create `.github/workflows/ci.yml`:

```yaml
name: CI - Lint & Test

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  backend-tests:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'
      
      - name: Install dependencies
        run: |
          cd backend
          pip install -r requirements.txt
      
      - name: Run linter
        run: |
          cd backend
          black --check .
          flake8 .
      
      - name: Run tests
        run: |
          cd backend
          pytest --cov=. --cov-report=xml
      
      - name: Upload coverage
        uses: codecov/codecov-action@v3

  flutter-tests:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up Flutter
        uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.24.5'
      
      - name: Install dependencies
        run: |
          cd mobile
          flutter pub get
      
      - name: Run analyzer
        run: |
          cd mobile
          flutter analyze
      
      - name: Run tests
        run: |
          cd mobile
          flutter test --coverage
      
      - name: Upload coverage
        uses: codecov/codecov-action@v3

  build-android:
    needs: [backend-tests, flutter-tests]
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up Flutter
        uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.24.5'
      
      - name: Build APK
        run: |
          cd mobile
          flutter build apk --release
      
      - name: Upload APK artifact
        uses: actions/upload-artifact@v3
        with:
          name: release-apk
          path: mobile/build/app/outputs/flutter-apk/app-release.apk
```

### Automated Deployment

Create `.github/workflows/deploy.yml`:

```yaml
name: Deploy to Production

on:
  push:
    branches: [main]
    tags:
      - 'v*'

jobs:
  deploy-backend:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Deploy to Vercel
        uses: amondnet/vercel-action@v25
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
          vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}
          working-directory: ./backend

  deploy-web:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up Flutter
        uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.24.5'
      
      - name: Build web
        run: |
          cd mobile
          flutter build web --release
      
      - name: Deploy to Vercel
        uses: amondnet/vercel-action@v25
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
          vercel-project-id: ${{ secrets.VERCEL_WEB_PROJECT_ID }}
          working-directory: ./mobile/build/web
```

---

## ğŸ§ª Automated Testing

### Test Generation Workflow

**Prompt to Sequential Thinking**:
```
Generate comprehensive test suite for WorkoutService:

Test scenarios:
1. Successful workout fetch
2. Network error handling
3. Empty response handling
4. Pagination
5. Filtering by date range
6. Cache hit/miss scenarios
7. Concurrent request handling

Include:
- Setup and teardown
- Mock data
- Edge cases
- Error scenarios
```

**Generated Test Example**:
```dart
import 'package:flutter_test/flutter_test.dart';
import 'package:mockito/mockito.dart';
import 'package:fitola/services/workout_service.dart';

void main() {
  late WorkoutService service;
  late MockApiClient mockClient;

  setUp(() {
    mockClient = MockApiClient();
    service = WorkoutService(client: mockClient);
  });

  group('WorkoutService', () {
    test('fetchWorkouts returns list on success', () async {
      // Arrange
      when(mockClient.get('/api/v1/workouts'))
        .thenAnswer((_) async => Response(
          data: {'workouts': [
            {'id': 1, 'name': 'Morning Run'},
            {'id': 2, 'name': 'Evening Gym'},
          ]},
          statusCode: 200,
        ));

      // Act
      final workouts = await service.fetchWorkouts();

      // Assert
      expect(workouts.length, 2);
      expect(workouts[0].name, 'Morning Run');
    });

    test('fetchWorkouts handles network error', () async {
      // Arrange
      when(mockClient.get('/api/v1/workouts'))
        .thenThrow(NetworkException('Connection failed'));

      // Act & Assert
      expect(
        () => service.fetchWorkouts(),
        throwsA(isA<NetworkException>()),
      );
    });

    // ... more tests
  });
}
```

---

## ğŸ“¦ Deployment Automation

### One-Command Deployment Script

Create `deploy.sh`:

```bash
#!/bin/bash

set -e

echo "ğŸš€ Fitola Deployment Script"
echo "=========================="

# Check for required tools
command -v git >/dev/null 2>&1 || { echo "âŒ git is required"; exit 1; }
command -v python >/dev/null 2>&1 || { echo "âŒ python is required"; exit 1; }
command -v flutter >/dev/null 2>&1 || { echo "âŒ flutter is required"; exit 1; }

# Parse arguments
ENVIRONMENT=${1:-production}
BUILD_MOBILE=${2:-true}

echo "ğŸ“‹ Environment: $ENVIRONMENT"
echo "ğŸ“± Build Mobile: $BUILD_MOBILE"

# Run tests
echo ""
echo "ğŸ§ª Running tests..."
cd backend && pytest && cd ..
cd mobile && flutter test && cd ..

# Build backend
echo ""
echo "ğŸ—ï¸ Building backend..."
cd backend
pip install -r requirements.txt
cd ..

# Deploy backend
echo ""
echo "ğŸš€ Deploying backend to Vercel..."
cd backend
vercel --prod --confirm
cd ..

# Build mobile (if requested)
if [ "$BUILD_MOBILE" = "true" ]; then
  echo ""
  echo "ğŸ“± Building mobile apps..."
  cd mobile
  
  # Android
  echo "Building Android APK..."
  flutter build apk --release
  
  # Web
  echo "Building Web app..."
  flutter build web --release
  
  cd ..
fi

echo ""
echo "âœ… Deployment complete!"
echo ""
echo "Backend: https://fitola.vercel.app"
echo "Web App: https://fitola-web.vercel.app"
```

Make it executable:
```bash
chmod +x deploy.sh
```

Usage:
```bash
# Deploy everything
./deploy.sh production true

# Deploy backend only
./deploy.sh production false

# Deploy to staging
./deploy.sh staging true
```

---

## ğŸ” Code Quality Automation

### Pre-commit Hooks

Create `.git/hooks/pre-commit`:

```bash
#!/bin/bash

echo "ğŸ” Running pre-commit checks..."

# Backend checks
echo "Checking backend code..."
cd backend

# Format check
if ! black --check .; then
  echo "âŒ Backend code needs formatting. Run: black ."
  exit 1
fi

# Lint check
if ! flake8 .; then
  echo "âŒ Backend linting failed"
  exit 1
fi

cd ..

# Flutter checks
echo "Checking Flutter code..."
cd mobile

# Format check
if ! flutter format --set-exit-if-changed .; then
  echo "âŒ Flutter code needs formatting. Run: flutter format ."
  exit 1
fi

# Analyze
if ! flutter analyze; then
  echo "âŒ Flutter analysis failed"
  exit 1
fi

cd ..

echo "âœ… All checks passed!"
```

### Automated Code Review

**Prompt to Sequential Thinking**:
```
Review this pull request for:
- Code quality
- Security vulnerabilities
- Performance issues
- Best practices
- Test coverage

Provide actionable feedback with examples.
```

---

## ğŸ“ Documentation Automation

### Auto-generate API Documentation

**Prompt to Sequential Thinking**:
```
Generate OpenAPI/Swagger documentation for all endpoints in main.py:

Include:
- Endpoint descriptions
- Request/response schemas
- Authentication requirements
- Example requests
- Error codes
```

### Auto-update README

**Prompt to Sequential Thinking**:
```
Update README.md with:
- New features from CHANGELOG.md
- Updated dependency versions from requirements.txt
- New API endpoints from main.py
- Maintain existing structure and badges
```

---

## ğŸ¯ Best Practices

### Automation Principles

1. **Start Simple**: Automate one workflow at a time
2. **Test First**: Ensure automation is reliable
3. **Monitor**: Add logging and notifications
4. **Document**: Keep automation docs up-to-date
5. **Iterate**: Continuously improve workflows

### Workflow Tips

âœ… **Do**:
- Use specific, clear prompts
- Break complex tasks into steps
- Validate generated code
- Maintain version control
- Document custom workflows

âŒ **Don't**:
- Blindly trust generated code
- Skip testing automated changes
- Forget to review security
- Neglect error handling
- Over-automate prematurely

---

## ğŸ†˜ Troubleshooting

### Common Issues

**Issue**: "Automation script fails midway"
- **Solution**: Add error handling and checkpoints
- **Example**: Use `set -e` in bash scripts

**Issue**: "Generated code doesn't compile"
- **Solution**: Refine prompts with more context
- **Example**: Include existing code structure

**Issue**: "Tests fail after automation"
- **Solution**: Run tests before and after
- **Example**: Integrate tests in automation script

---

## ğŸ“ Support

Need help with automation?
- **GitHub Issues**: https://github.com/saanjaypatil78/fitola/issues
- **Documentation**: See `docs/` folder
- **Email**: your.email@example.com

---

**Automate Smarter, Build Faster** ğŸš€

*Built with â¤ï¸ using AI-powered automation*
